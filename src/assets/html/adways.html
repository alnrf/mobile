<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0">
    <style type="text/css">
      body {
        background-color: transparent;
      }
    </style>
    <script type="text/javascript" src="//dj5ag5n6bpdxo.cloudfront.net/libs/interactive/loader.js"></script>
    <script type="text/javascript">
      const init = ({publicationId}) => {
        const experience = new adways.interactive.Experience();
        experience.setPublicationID(publicationId);
        experience.setPlayerAPI(document.getElementById('container'));
        experience.setPlayerClass('coorpwebview');
        experience.load();
      };

      const handleReactNativeMessage = data => {
        console.log('@webview', 'handleReactNativeMessage', data);

        const message = JSON.parse(data);

        if (!message.isFromReactNative) {
          return;
        }

        if (message.type === 'init') {
          const {publicationId} = message;
          return init({publicationId});
        }

        window.postMessage(JSON.stringify({
          ...message,
          isFromReactNative: true
        }));
      };

      const handleMessage = data => {
        console.log('@webview', 'handleMessage', data);

        const message = JSON.parse(data);

        if (message.isFromReactNative) {
          return;
        }

        window.ReactNativeWebView.postMessage(JSON.stringify(message));
      };

      window.ReactNativeWebView.addEventListener('message', handleReactNativeMessage);
      window.addEventListener('message', handleMessage);
    </script>
  </head>
  <body id="container" />
</html>
